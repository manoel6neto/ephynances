<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition template="/template.xhtml"> 
        <ui:define name="title"> 
            <h:outputText  value="Detalhes do pagamento: #{paymentDocumentController.formatDate(paymentDocumentController.payment.paymentDate)}"/>
        </ui:define>
        <ui:define name="body"  >
            <h:form id="form" enctype="multipart/form-data" prependId="true">
                <br class="clear" />
                <br/>
                <p:fieldset legend="Detalhes do Contrato/Pagamento/Parcela" toggleable="true" collapsed="false">
                    <br class="clear" />
                    <div >
                        <p:outputLabel value="Contrato: #{paymentDocumentController.payment.agreementInstallment.agreement.physisAgreementNumber}" style="color: #000000; font-style: oblique; font-size: medium"/>
                    </div>

                    <br class="clear" />
                    <div >
                        <p:outputLabel value="Status contrato: #{paymentDocumentController.payment.agreementInstallment.agreement.status}" style="color: #000000; font-style: oblique; font-size: medium"/>
                    </div>

                    <br class="clear" />
                    <div >
                        <p:outputLabel value="Valor da parcela: #{paymentDocumentController.payment.agreementInstallment.value}" style="color: #000000; font-style: oblique; font-size: medium"/>
                    </div>
                    
                    <br class="clear" />
                    <div >
                        <p:outputLabel value="Valor do pagamento: #{paymentDocumentController.payment.totalValue}" style="color: #000000; font-style: oblique; font-size: medium"/>
                    </div>

                    <br class="clear" />
                    <div >
                        <p:outputLabel value="Status da parcela: #{paymentDocumentController.payment.agreementInstallment.status}" style="color: #000000; font-style: oblique; font-size: medium"/>
                    </div>
                    
                    <br class="clear" />
                    <br/>
                </p:fieldset>

                <br class="clear" />
                <br/>
                <p:fieldset legend="Upload de documento" toggleable="true" collapsed="false">
                    <br class="clear" />
                    <div class="grid_3 alpha" >
                        <p:outputLabel value="Nome do documento: " for="nameDocument" />
                        <p:inputText id="nameDocument" style="width: 200px" value="#{paymentDocumentController.paymentDocument.name}" required="false" /> 
                    </div>

                    <br class="clear" />
                    <br/>
                    <div class="grid_3 alpha" >
                        <p:outputLabel value="Descrição do documento: " for="descriptionDocument" />
                        <p:inputTextarea id="descriptionDocument" rows="6" cols="60" value="#{paymentDocumentController.paymentDocument.description}" required="false" /> 
                    </div>

                    <br class="clear" />
                    <br/>
                    <div class="grid_3 alpha" >
                        <p:fileUpload value="#{paymentDocumentController.file}" mode="simple" previewWidth="200" />
                    </div>

                    <br class="clear" />
                    <br/>
                    <div class="grid_3 alpha" >
                        <p:commandButton id="uploadFileButton" value="Upload" update="@form" ajax="false" actionListener="#{paymentDocumentController.upload()}" />
                    </div>

                    <br class="clear" />
                    <br/>
                </p:fieldset>

                <br class="clear" />
                <br/>
                <p:fieldset legend="Documentos do pagamento" toggleable="true" collapsed="false">
                    <br class="clear" />
                    <br/>
                    <p:dataTable id="table" widgetVar="table" value="#{paymentDocumentController.payment.paymentDocuments}" var="item" lazy="false" 
                                 rows="15" paginator="true"  paginatorPosition="bottom" 
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                 currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}"
                                 emptyMessage="Nenhum documento encontrado!">

                        <p:column style="text-align: center" headerText="Nome" filterBy="#{item.name}" filterStyle="text-align: center; width: 140px;">                       
                            <h:outputText value="#{item.name}" />
                        </p:column>

                        <p:column style="text-align: center" headerText="Descrição" filterBy="#{item.description}" filterStyle="text-align: center; width: 140px;">                       
                            <h:outputText value="#{item.description}" />
                        </p:column>

                        <p:column width="60" style="text-align: center" headerText="Ações">
                            <p:commandLink update="table" style="margin-right: 5px" ajax="false" ><img src="../resources/img/edit.png" width="16" height="16" alt="Baixar documento" title="Baixar documento"/>
                                <p:fileDownload value="#{paymentDocumentController.downloadDocument(item.id)}" />
                            </p:commandLink>
                            <h:outputText value="   " />
                            <p:commandLink ajax="false" update="table" style="margin-right: 5px" actionListener="#{paymentDocumentController.removeDocument(item.id)}" >
                                <img src="../resources/img/remove.png" width="16" height="16" alt="Apagar documento" title="Apagar documento"/>
                                <p:confirm header="Confirmação" message="Você tem certeza que gostaria de apagar o documento?" icon="ui-icon-alert"/>
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>

                    <br class="clear" />
                    <br/>
                </p:fieldset>

                <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                    <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                    <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                </p:confirmDialog>
            </h:form>
        </ui:define>
    </ui:composition>


</html>