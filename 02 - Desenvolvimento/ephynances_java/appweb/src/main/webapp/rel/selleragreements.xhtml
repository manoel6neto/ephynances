<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core" >

    <ui:composition template="/template.xhtml"> 
        <ui:define name="title"> 
            <h:outputText style="font-size: large" value="CONTRATOS POR REPRESENTANTE"/>
        </ui:define>
        <ui:define name="body"  >
            <h:form id="form" >
                <p:messages autoUpdate="true" showSummary="true" showDetail="true" />
                <br class="clear" />
                <p:fieldset legend="Filtro" toggleable="true" collapsed="false">
                    <br class="clear" />
                    <br />
                    <div style="alignment-adjust: central; vertical-align: central;" >
                        <p:outputLabel value="Representantes: " for="menuRepresentantes" /><br />
                        <p:selectOneMenu id="menuRepresentantes" style="width: 200px" value="#{relController.selectUser}" required="false" effect="fade" converter="userConverter">
                            <f:selectItem noSelectionOption="true" itemLabel="Todos" />
                            <f:selectItems value="#{relController.sellerList}" var="seller" itemLabel="#{seller.name}" itemValue="#{seller}" />
                        </p:selectOneMenu>
                        <p:commandButton style="color: #FF0000; vertical-align: top; alignment-adjust: central; margin-left: 10px; height: 25px;" action="#{relController.calcAgreementForSeller()}" value="Filtrar" update="form" ajax="false"/>
                    </div>
                    <br class="clear" />
                    <br />
                </p:fieldset>

                <br class="clear" />
                <br />
                <p:fieldset legend="Dados" toggleable="true" collapsed="false" >
                    <br class="clear" />
                    <br />
                    <div class="grid_4 alpha">
                        <p:panel closable="false" style="padding: 15px; width: 1065px" >
                            <h:outputText value="Valores Atualizados: " style="font-style: oblique; font-size: large; margin-right: 15px;" />
                            <h:outputText value="#{relController.formatValueToReais(relController.totalValueAgreementsSeller.setScale(2))}" style="color: #FAFAFA; font-style: oblique; font-size: large; background-color: dodgerblue; padding: 10px;" />
                        </p:panel>
                    </div>

                    <br class="clear" />
                    <br />
                    <br />
                    <div>
                        <p:accordionPanel style="background-color: #D2D2D2; border: solid; border-width: 1px; border-color: #EBE9DE" value="#{relController.agreementsSellers}" var="agreement" multiple="true" rendered="#{relController.agreementsSellers.size() > 0}">
                            <p:tab title="#{agreement.physisAgreementNumber}" titleStyle="color: #FF0000; font-style: oblique;" >
                                <br class="clear" />
                                <div>
                                    <br />
                                    <h:outputText value="#{relController.formatValueToReais(agreement.totalPrice.setScale(2))}" style="color: #FAFAFA; font-style: oblique; font-size: large; background-color: green; padding: 10px;" />
                                    <br />
                                    <br />
                                    <br />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="Vendedor: " for="vendedor"/>
                                    <h:outputText id="vendedor" value="#{agreement.user.name}" /><p></p>
                                    <p:separator />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="Proponente: " for="proponente"/>
                                    <h:outputText id="proponente" value="#{relController.checkProponent(agreement.idPrimaryCnpj)}" /><p></p>
                                    <p:separator />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="N. Contrato do proponente: " for="contractPropo"/>
                                    <h:outputText id="contractPropo" value="#{agreement.contactAgreementNumber}" /><p></p>
                                    <p:separator />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="Data Assinatura: " for="dateAss"/>
                                    <h:outputText id="dateAss" value="#{relController.formatDate(agreement.assignmentDate)}" /><p></p>
                                    <p:separator />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="Data vencimento: " for="dateVenc"/>
                                    <h:outputText id="dateVenc" value="#{relController.formatDate(agreement.expireDate)}" />
                                    <p:separator />
                                    <h:outputLabel style="font-style: oblique; font-weight: bold;" value="Quant. Parcelas: " for="countParc"/>
                                    <h:outputText id="countParc" value="#{relController.countParc(agreement.id)}" /><p></p>
                                    <br />
                                </div>
                            </p:tab>
                        </p:accordionPanel>
                        <br />
                        <h:outputText value="Nenhum registro encontrado" style="font-style: oblique; font-size: medium; text-align: center;" rendered="#{relController.agreementsSellers.size() == 0}"/>
                    </div>
                </p:fieldset>
            </h:form>
        </ui:define>
    </ui:composition>
</html>